<idea-plugin>
    <id>com.hytaledocs.hytale</id>
    <name>Hytale Docs Dev Tools</name>
    <vendor email="contact@hytale-docs.com" url="https://hytale-docs.com">HytaleDocs</vendor>

    <description><![CDATA[
        <p>A comprehensive toolkit for developing Hytale server plugins in IntelliJ IDEA.</p>

        <h3>Features</h3>
        <ul>
            <li><b>Project Wizard</b> - Create new Hytale plugin projects with Gradle setup</li>
            <li><b>Run Configuration</b> - Build, Deploy & Debug with one click</li>
            <li><b>Assets Explorer</b> - Preview images, audio, and JSON files</li>
            <li><b>UI File Support</b> - Syntax highlighting for .ui files</li>
            <li><b>Live Templates</b> - Quick code snippets (hyevent, hycmd, hyecs...)</li>
            <li><b>API Completion</b> - Autocomplete for Hytale server classes</li>
            <li><b>Documentation</b> - Browse docs directly in IDE</li>
        </ul>

        <h3>Community</h3>
        <p>
            <a href="https://discord.gg/yAjaFBH4Y8">Join our Discord</a> |
            <a href="https://hytale-docs.com">Documentation</a> |
            <a href="https://github.com/HytaleDocs/hytale-intellij-plugin">GitHub</a>
        </p>
    ]]></description>

    <change-notes><![CDATA[
        <h3>1.3.2</h3>
        <ul>
            <li><b>Run Configuration</b> - Build, Deploy & Debug Hytale servers with one click</li>
            <li><b>UI File Support</b> - Syntax highlighting, completion & color preview for .ui files</li>
            <li><b>Dynamic Debug Port</b> - Automatically finds available port (5005-5015)</li>
            <li><b>Auto-detect Plugin</b> - Detects plugin info from manifest.json</li>
            <li><b>Windows Fix</b> - Server restart workflow fixes JAR file locking</li>
            <li><b>Code Cleanup</b> - Removed deprecated APIs and unused code</li>
        </ul>

        <h3>1.3.1</h3>
        <ul>
            <li>Assets Explorer improvements</li>
            <li>Deploy fixes</li>
        </ul>

        <h3>1.3.0</h3>
        <ul>
            <li>New HytaleDocs branding</li>
            <li>Hytale API autocomplete</li>
        </ul>
    ]]></change-notes>

    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>

    <resource-bundle>messages.HytaleBundle</resource-bundle>

    <extensions defaultExtensionNs="com.intellij">
        <!-- New Project Wizard - Appears in "New Project" section -->
        <newProjectWizard.languageGenerator
                implementation="com.hytaledocs.intellij.wizard.HytaleNewProjectWizard"/>

        <!-- File Templates -->
        <internalFileTemplate name="Hytale Mod"/>
        <internalFileTemplate name="Hytale Listener"/>
        <internalFileTemplate name="Hytale Command"/>
        <internalFileTemplate name="Hytale ECS System"/>
        <internalFileTemplate name="Hytale UI File"/>

        <!-- ==================== Hytale UI File Support ==================== -->

        <!-- UI File Type Registration -->
        <fileType
                name="Hytale UI File"
                implementationClass="com.hytaledocs.intellij.uifile.UIFileType"
                fieldName="INSTANCE"
                language="HytaleUI"
                extensions="ui"/>

        <!-- UI Language Parser -->
        <lang.parserDefinition
                language="HytaleUI"
                implementationClass="com.hytaledocs.intellij.uifile.parser.UIParserDefinition"/>

        <!-- UI Syntax Highlighting -->
        <lang.syntaxHighlighterFactory
                language="HytaleUI"
                implementationClass="com.hytaledocs.intellij.uifile.highlighter.UISyntaxHighlighterFactory"/>

        <!-- UI Brace Matching -->
        <lang.braceMatcher
                language="HytaleUI"
                implementationClass="com.hytaledocs.intellij.uifile.UIBraceMatcher"/>

        <!-- UI Code Folding -->
        <lang.foldingBuilder
                language="HytaleUI"
                implementationClass="com.hytaledocs.intellij.uifile.UIFoldingBuilder"/>

        <!-- UI Commenting -->
        <lang.commenter
                language="HytaleUI"
                implementationClass="com.hytaledocs.intellij.uifile.UICommenter"/>

        <!-- UI Code Completion -->
        <completion.contributor
                language="HytaleUI"
                implementationClass="com.hytaledocs.intellij.uifile.completion.UICompletionContributor"/>

        <!-- UI Color Preview (gutter icons) -->
        <annotator
                language="HytaleUI"
                implementationClass="com.hytaledocs.intellij.uifile.highlighter.UIColorAnnotator"/>

        <!-- UI Color Settings Page -->
        <colorSettingsPage
                implementation="com.hytaledocs.intellij.uifile.highlighter.UIColorSettingsPage"/>



        <!-- Live Templates -->
        <defaultLiveTemplates file="/liveTemplates/Hytale.xml"/>
        <liveTemplateContext
                contextId="HYTALE"
                implementation="com.hytaledocs.intellij.templates.HytaleTemplateContext"/>

        <!-- Tool Window -->
        <toolWindow
                factoryClass="com.hytaledocs.intellij.toolWindow.HytaleToolWindowFactory"
                id="HytaleDocs"
                anchor="right"
                icon="/icons/hytaledocs-plugin-13.svg"/>

        <!-- Notifications -->
        <notificationGroup
                id="Hytale Plugin"
                displayType="BALLOON"/>

        <!-- Settings -->
        <projectConfigurable
                parentId="tools"
                instance="com.hytaledocs.intellij.settings.HytaleSettingsConfigurable"
                id="com.hytaledocs.intellij.settings.HytaleSettings"
                displayName="Hytale Server"
                nonDefaultProject="true"/>

        <!-- Services -->
        <projectService
                serviceImplementation="com.hytaledocs.intellij.settings.HytaleServerSettings"/>
        <projectService
                serviceImplementation="com.hytaledocs.intellij.services.ServerDownloadService"/>
        <projectService
                serviceImplementation="com.hytaledocs.intellij.services.ServerLaunchService"/>
        <projectService
                serviceImplementation="com.hytaledocs.intellij.services.HytaleProjectService"/>
        <projectService
                serviceImplementation="com.hytaledocs.intellij.services.AssetScannerService"/>
        <projectService
                serviceImplementation="com.hytaledocs.intellij.services.AssetSyncService"/>

        <applicationService
                serviceImplementation="com.hytaledocs.intellij.services.JavaInstallService"/>
        <applicationService
                serviceImplementation="com.hytaledocs.intellij.services.HytaleDownloaderService"/>
        <applicationService
                serviceImplementation="com.hytaledocs.intellij.services.AuthenticationService"/>
        <applicationService
                serviceImplementation="com.hytaledocs.intellij.services.DocumentationService"/>
        <applicationService
                serviceImplementation="com.hytaledocs.intellij.services.DocumentationApiClient"/>

        <!-- Documentation Provider for F1 Help -->
        <lang.documentationProvider
                language="JAVA"
                implementationClass="com.hytaledocs.intellij.documentation.HytaleDocumentationProvider"
                order="first"/>

        <!-- Server Data Service for API completion data -->
        <applicationService
                serviceImplementation="com.hytaledocs.intellij.services.ServerDataService"/>
        <applicationService
                serviceImplementation="com.hytaledocs.intellij.services.OfflineDocsService"/>

        <!-- Code Completion for Hytale API -->
        <completion.contributor
                language="JAVA"
                implementationClass="com.hytaledocs.intellij.completion.HytaleCompletionContributor"
                order="first"/>

        <!-- Run Configuration for Hytale Server -->
        <configurationType
                implementation="com.hytaledocs.intellij.run.HytaleServerConfigurationType"/>

        <!-- Debug Runner for Hytale Server -->
        <programRunner
                implementation="com.hytaledocs.intellij.run.HytaleServerDebugRunner"/>

        <!-- Auto-setup Run Configuration for Hytale projects -->
        <postStartupActivity
                implementation="com.hytaledocs.intellij.run.HytaleRunConfigurationSetup"/>
    </extensions>

    <actions>
        <group id="HytaleDocs.NewGroup" text="Hytale" description="Hytale mod development">
            <add-to-group group-id="NewGroup" anchor="after" relative-to-action="NewGroup1"/>

            <action id="HytaleDocs.NewMod"
                    class="com.hytaledocs.intellij.actions.NewPluginAction"
                    text="Hytale Plugin"
                    description="Create a new Hytale plugin class"
                    icon="/icons/hytaledocs-plugin-16.svg"/>

            <action id="HytaleDocs.NewListener"
                    class="com.hytaledocs.intellij.actions.NewListenerAction"
                    text="Hytale Listener"
                    description="Create a new Hytale event listener"/>

            <action id="HytaleDocs.NewCommand"
                    class="com.hytaledocs.intellij.actions.NewCommandAction"
                    text="Hytale Command"
                    description="Create a new Hytale command"/>

            <action id="HytaleDocs.NewUIFile"
                    class="com.hytaledocs.intellij.uifile.action.NewUIFileAction"
                    text="Hytale UI File"
                    description="Create a new Hytale UI definition file"
                    icon="/icons/ui-file.svg"/>
        </group>


        <group id="HytaleDocs.ToolsMenu" text="Hytale Server" description="Hytale server management">
            <add-to-group group-id="ToolsMenu" anchor="last"/>

            <action id="HytaleDocs.SetupServer"
                    class="com.hytaledocs.intellij.actions.SetupServerAction"
                    text="Setup Server..."
                    description="Download Java 25 and server files for Hytale development"
                    icon="/icons/hytaledocs-plugin-16.svg"/>

            <action id="HytaleDocs.DownloadServerJar"
                    class="com.hytaledocs.intellij.actions.DownloadServerJarAction"
                    text="Download Server JAR"
                    description="Download the latest HytaleServer.jar from CDN"/>

            <separator/>

            <action id="HytaleDocs.QuickReloadPlugins"
                    class="com.hytaledocs.intellij.actions.QuickReloadPluginsAction"
                    text="Reload All Plugins"
                    description="Send /reload plugins command to the running Hytale server"
                    icon="AllIcons.Actions.Refresh"/>

            <action id="HytaleDocs.HotReloadPlugin"
                    class="com.hytaledocs.intellij.actions.HotReloadPluginAction"
                    text="Hot Reload Plugin"
                    description="Build and reload your plugin on the running server (Build → Unload → Deploy → Load)"
                    icon="AllIcons.Actions.ForceRefresh"/>

            <separator/>

            <action id="HytaleDocs.ReconfigureRunConfig"
                    class="com.hytaledocs.intellij.actions.ReconfigureRunConfigAction"
                    text="Reconfigure Run Configuration"
                    description="Auto-detect plugin info and update the Hytale Server run configuration"
                    icon="AllIcons.Actions.Refresh"/>
        </group>
    </actions>
</idea-plugin>
